<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>URL轉換器</title>
</head>
<body>
    <!-- 修改sukebei網址一鍵改為可以直接餵給Aria2機器人的網址 -->
    <h1>URL轉換器</h1>
    <label for="urlInput">輸入網址:</label>
    <input type="text" id="urlInput" placeholder="https://sukebei.nyaa.si/download/4152421.torrent">
    <button onclick="convertUrl()">轉換</button>
    <p>修改後網址: <span id="result"></span></p>
    <p>Magnet網址: <span id="magnetLink"></span></p>

    <script>
        function convertUrl() {
            const inputUrl = document.getElementById('urlInput').value;
            const modifiedUrl = inputUrl.replace('/download/', '/view/').replace('.torrent', '');
            document.getElementById('result').innerText = modifiedUrl;

            // 自動瀏覽網頁並獲取Magnet按鈕的網址
            fetch(modifiedUrl)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const magnetLinkElement = doc.querySelector('a[href^="magnet:"]');
                    if (magnetLinkElement) {
                        const magnetLink = magnetLinkElement.href;
                        document.getElementById('magnetLink').innerText = magnetLink;
                    } else {
                        document.getElementById('magnetLink').innerText = '未找到Magnet網址';
                    }
                })
                .catch(error => console.error('Error:', error));
        }
    </script>
</body>
</html>
